#!/usr/bin/env python3
"""
é¡¹ç›®åˆå§‹åŒ–è„šæœ¬ - è®© Claude Code äº†è§£é¡¹ç›®é…ç½®
è¿è¡Œæ­¤è„šæœ¬å‘Šè¯‰ Claude å½“å‰é¡¹ç›®çš„è®¾ç½®
"""

import os
import json
from datetime import datetime

# é¡¹ç›®é…ç½®ä¿¡æ¯
PROJECT_CONFIG = {
    "project_name": "Claude Code Project",
    "initialized_at": datetime.now().isoformat(),
    "config_files": {
        "main_config": "claude.md",
        "server_config": ".claude/config.yaml"
    },
    
    "server_info": {
        "host": "2a09:8280:1::92:6611:0",
        "port": 22,
        "username": "root",
        "password": "Solemn520!",
        "remote_path": "/wwwroot/",
        "connection_type": "SFTP"
    },
    
    "code_protection": {
        "enabled": True,
        "max_delete_lines": 5,
        "backup_required": True
    },
    
    "execution_limits": {
        "max_failures": 5,
        "max_tool_retries": 2,
        "max_mcp_calls": 3
    },
    
    "cleanup_patterns": [
        "test_*",
        "temp_*", 
        "debug_*",
        "*.tmp",
        "*.temp"
    ],
    
    "common_tasks": {
        "upload_to_server": "ä½¿ç”¨ SFTP ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨",
        "test_server_connection": "æµ‹è¯•æœåŠ¡å™¨è¿æ¥çŠ¶æ€",
        "backup_code": "åˆ›å»ºä»£ç å¤‡ä»½",
        "cleanup_temp_files": "æ¸…ç†ä¸´æ—¶æµ‹è¯•æ–‡ä»¶"
    }
}

def main():
    """åˆå§‹åŒ–é¡¹ç›®é…ç½®"""
    print("ğŸš€ Claude Code é¡¹ç›®åˆå§‹åŒ–")
    print("=" * 50)
    
    # åˆ›å»ºé…ç½®ç›®å½•
    os.makedirs(".claude", exist_ok=True)
    
    # ä¿å­˜é…ç½®æ–‡ä»¶
    config_path = ".claude/project_config.json"
    with open(config_path, 'w', encoding='utf-8') as f:
        json.dump(PROJECT_CONFIG, f, ensure_ascii=False, indent=2)
    
    print(f"âœ… é…ç½®æ–‡ä»¶å·²åˆ›å»º: {config_path}")
    print(f"âœ… æœåŠ¡å™¨ä¿¡æ¯: {PROJECT_CONFIG['server_info']['host']}")
    print(f"âœ… ä»£ç ä¿æŠ¤: {'å¯ç”¨' if PROJECT_CONFIG['code_protection']['enabled'] else 'ç¦ç”¨'}")
    
    # åˆ›å»º Claude æç¤ºæ–‡ä»¶
    prompt_file = ".claude/current_context.md"
    with open(prompt_file, 'w', encoding='utf-8') as f:
        f.write(f"""# å½“å‰é¡¹ç›®ä¸Šä¸‹æ–‡
        
é¡¹ç›®å·²åˆå§‹åŒ–ï¼Œé…ç½®ä¿¡æ¯ï¼š

## æœåŠ¡å™¨ä¿¡æ¯
- åœ°å€: {PROJECT_CONFIG['server_info']['host']}
- ç«¯å£: {PROJECT_CONFIG['server_info']['port']} 
- ç”¨æˆ·: {PROJECT_CONFIG['server_info']['username']}
- å¯†ç : {PROJECT_CONFIG['server_info']['password']}
- è·¯å¾„: {PROJECT_CONFIG['server_info']['remote_path']}

## é‡è¦æ–‡ä»¶
- ä¸»é…ç½®: claude.md
- é¡¹ç›®é…ç½®: .claude/project_config.json

## ä½¿ç”¨è¯´æ˜
åœ¨ä¸ Claude Code äº¤äº’æ—¶ï¼Œè¯·å¼•ç”¨æ­¤æ–‡ä»¶çš„ä¿¡æ¯æ¥æ‰§è¡Œä»»åŠ¡ã€‚

åˆå§‹åŒ–æ—¶é—´: {PROJECT_CONFIG['initialized_at']}
""")
    
    print(f"âœ… ä¸Šä¸‹æ–‡æ–‡ä»¶å·²åˆ›å»º: {prompt_file}")
    print("\nğŸ’¡ ç°åœ¨å¯ä»¥å¯¹ Claude Code è¯´:")
    print("   'å‚è€ƒ .claude/current_context.md æ–‡ä»¶ï¼Œä¸Šä¼  xxx æ–‡ä»¶åˆ°æœåŠ¡å™¨'")

if __name__ == "__main__":
    main()